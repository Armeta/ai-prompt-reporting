{
    "templates":[
        {   "question":"How do sales in  PRODUCTFAMILY compare across different stores in STATE/DISTRICT?"
        ,   "desc":"How sales in  PRODUCTFAMILY compare across different stores in STATE/DISTRICT."
        ,   "category":"location-review"
        ,   "query":"WITH TOP_STORES AS (     SELECT TOP 3 LL.LOCATION_LABEL AS LOCATION_LABEL, LTRIM(TO_VARCHAR(SUM(REVENUE_DOLLARS_TY), '999,999,999,990')) AS REVENUE, RANK() OVER(ORDER BY SUM(REVENUE_DOLLARS_TY) DESC) AS R, LD.DISTRICT_LABEL, F.PRODUCT_FAMILY_LABEL     FROM DASHBOARD.STORY_LOCATION_REVIEW A     JOIN STORY.LKP_DISTRICT LD ON A.DISTRICT_CD = LD.DISTRICT_CD     JOIN STORY.LKP_LOCATION LL ON A.LOCATION_CD = LL.LOCATION_CD     JOIN STORY.LKP_DEPARTMENT D ON A.DEPARTMENT_CD = D.DEPARTMENT_CD     JOIN STORY.LKP_PRODUCT_FAMILY F ON D.PRODUCT_FAMILY_CD = F.PRODUCT_FAMILY_CD     WHERE LD.DISTRICT_LABEL = 'STATE/DISTRICT' AND F.PRODUCT_FAMILY_LABEL = 'PRODUCTFAMILY'     GROUP BY LL.LOCATION_LABEL, LD.DISTRICT_LABEL, F.PRODUCT_FAMILY_LABEL     ORDER BY SUM(REVENUE_DOLLARS_TY) DESC ), BOT_STORES AS (     SELECT TOP 1 LL.LOCATION_LABEL AS LOCATION_LABEL, LTRIM(TO_VARCHAR(SUM(REVENUE_DOLLARS_TY), '999,999,999,990')) AS REVENUE     FROM DASHBOARD.STORY_LOCATION_REVIEW A     JOIN STORY.LKP_DISTRICT LD ON A.DISTRICT_CD = LD.DISTRICT_CD     JOIN STORY.LKP_LOCATION LL ON A.LOCATION_CD = LL.LOCATION_CD     JOIN STORY.LKP_DEPARTMENT D ON A.DEPARTMENT_CD = D.DEPARTMENT_CD     JOIN STORY.LKP_PRODUCT_FAMILY F ON D.PRODUCT_FAMILY_CD = F.PRODUCT_FAMILY_CD     WHERE LD.DISTRICT_LABEL = 'STATE/DISTRICT' AND F.PRODUCT_FAMILY_LABEL = 'PRODUCTFAMILY'     GROUP BY LL.LOCATION_LABEL     ORDER BY SUM(REVENUE_DOLLARS_TY) ASC ) SELECT TOP 1 CONCAT('The top store in ', T1.DISTRICT_LABEL, ' for ', T1.PRODUCT_FAMILY_LABEL,' products is ', T1.LOCATION_LABEL, ' with $', T1.REVENUE, ' in sales. ', IFNULL(CONCAT('The store with the next highest sales is ', T2.LOCATION_LABEL, ' with $', T2.REVENUE, ' in sales. '), ''), 'The lowest ranking store in ', T1.PRODUCT_FAMILY_LABEL,' products is ', B1.LOCATION_LABEL, ' with $', B1.REVENUE, ' in sales.') FROM TOP_STORES T1 LEFT JOIN TOP_STORES T2 ON T2.R = 2 JOIN BOT_STORES B1 WHERE T1.R = 1;"
        ,   "parameters":[{"name":"STATE/DISTRICT", "values":["AL", "AZ", "CA", "CT", "GA", "IL", "IN", "LA", "MI", "NH", "NJ", "OR", "PA", "TN", "TX", "WA", "WV", "WY"]}
                            , {"name": "PRODUCTFAMILY", "values":["OTHER", "MENS", "WOMENS", "JUNIORS", "CHILDRENS", "COSMETICS", "ACCESSORIES", "SHOES", "HOME"]}]
        ,   "urlfilter":"{\"district\":[\"STATE/DISTRICT\"]}"
        ,   "urlquery":"{\"family\": PRODUCTFAMILY}"
        ,   "URLparameters":[{"name":"STATE/DISTRICT", "values":["1", "2", "3", "4", "5", "6", "7", "9", "13", "16", "17", "19", "22", "23", "24", "26", "27", "28"]}, {"name": "PRODUCTFAMILY", "values":[0, 1, 3, 4, 5, 6, 7, 8, 9]}]
        }
    ]
}