{
   "templates":[
       {   "question":"How is STORE/LOCATION/CITY ranked amongst all stores"
       ,   "desc":"Store Ranking by revenue or sales or REVENUE_DOLLARS_TY"
       ,   "category":"STORY_RETAIL_SALES_ANALYSIS"
       ,   "query":"WITH RANKS AS (SELECT L.LOCATION_LABEL, RANK() OVER (ORDER BY SUM(REVENUE_DOLLARS_TY) DESC ) AS LOCATION_RANK FROM ARMETA_AI.DASHBOARD.STORY_RETAIL_SALES_ANALYSIS A JOIN ARMETA_AI.STORY.LKP_LOCATION L ON A.LOCATION_CD = L.LOCATION_CD GROUP BY L.LOCATION_LABEL ) SELECT L.LOCATION_LABEL, R.LOCATION_RANK FROM DASHBOARD.STORY_RETAIL_SALES_ANALYSIS A JOIN ARMETA_AI.STORY.LKP_LOCATION L ON A.LOCATION_CD = L.LOCATION_CD JOIN RANKS R ON R.LOCATION_LABEL = L.LOCATION_LABEL GROUP BY L.LOCATION_LABEL, R.LOCATION_RANK"
       ,   "parameters":[{"name":"STORE/LOCATION/CITY", "values":["PORTLAND,OR", "HOUSTON,TX", "FLAGSTAFF,AZ", "BATONROUGE,LA", "JACKSON,MI", "COLUMBUS,IN", "EUGENE,OR", "NEWORLEANS,LA", "BIRMINGHAM,AL", "SAN DIEGO,CA", "HERSHEY,PA", "ELPASO,TX", "LANCASTER,PA", "MIDDLETOWN,WV", "SEATTLE,WA", "PITTSBURGH,PA", "KOKOMO,IN", "PHILADELPHIA,PA", "YORK,PA", "HUNTSVILLE,AL", "DALLAS,TX", "EUREKA,CA", "TACOMA,WA", "PERU,IL", "HARTFORD,CT", "FORTWORTH,TX", "BLOOMNGTN,IL", "AUSTIN,TX", "MACON,GA", "WACO,TX", "BRICK,NJ", "MANCHESTER ,NH", "CONCORD,NH", "ROCKSPRNG,WY", "KNOXVILLE,TN", "OLYMPIA,WA", "BILOXI,MI"]}]
       },          
       {   "question":"What is the category with the biggest sales opportunity at STORE/LOCATION/CITY?"
       ,   "desc":"The category or genre with the biggest or most sales opportunity at STORE/LOCATION/CITY"
       ,   "category":"Sales-Opportunity"
       ,   "query":"WITH Find_LocationName AS (SELECT TOP 1 LOCATION_LABEL, REGEXP_SUBSTR(LOCATION_DESC, '[a-zA-Z][a-zA-Z ]+') AS LOCATION_DESC FROM ARMETA_AI.STORY.LKP_LOCATION L WHERE RTRIM(LTRIM(LOWER(LOCATION_DESC))) LIKE CONCAT('%', LOWER('STORE/LOCATION/CITY'), '%') ), Find_TopCategory AS (SELECT CATEGORY_LABEL, LOCATION_LABEL, SUM(OPPS) AS OPPORTUNITY FROM ARMETA_AI.DASHBOARD.STORY_SALES_ACCELERATOR SA JOIN ARMETA_AI.STORY.LKP_CATEGORY C ON SA.CATEGORY_CD = C.CATEGORY_CD JOIN ARMETA_AI.STORY.LKP_LOCATION L ON SA.LOCATION_CD = L.LOCATION_CD WHERE OPPS IS NOT NULL GROUP BY CATEGORY_LABEL, LOCATION_LABEL ORDER BY OPPORTUNITY DESC ) SELECT CATEGORY_LABEL, OPPORTUNITY FROM Find_LocationName LN JOIN Find_TopCategory TC ON LN.LOCATION_LABEL = TC.LOCATION_LABEL ORDER BY OPPORTUNITY DESC"
       ,   "parameters":[{"name":"STORE/LOCATION/CITY", "values":["PORTLAND,OR", "HOUSTON,TX", "FLAGSTAFF,AZ", "BATONROUGE,LA", "JACKSON,MI", "COLUMBUS,IN", "EUGENE,OR", "NEWORLEANS,LA", "BIRMINGHAM,AL", "SAN DIEGO,CA", "HERSHEY,PA", "ELPASO,TX", "LANCASTER,PA", "MIDDLETOWN,WV", "SEATTLE,WA", "PITTSBURGH,PA", "KOKOMO,IN", "PHILADELPHIA,PA", "YORK,PA", "HUNTSVILLE,AL", "DALLAS,TX", "EUREKA,CA", "TACOMA,WA", "PERU,IL", "HARTFORD,CT", "FORTWORTH,TX", "BLOOMNGTN,IL", "AUSTIN,TX", "MACON,GA", "WACO,TX", "BRICK,NJ", "MANCHESTER ,NH", "CONCORD,NH", "ROCKSPRNG,WY", "KNOXVILLE,TN", "OLYMPIA,WA", "BILOXI,MI"]}]
       }
      ]
}